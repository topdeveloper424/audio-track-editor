{% extends 'layouts/main.html' %} {% load static %} {% block title %} audio tool {% endblock %} {% block style %}
<link rel="stylesheet" type="text/css" href="{% static 'vendors/css/dropzone.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'vendors/css/toastr.css' %}">
<style>
    .dropzone .dz-message {
        margin: 0 0!important;
        font-size: 1rem!important;
        top: 35%!important;
    }
    
    .dropzone {
        min-height: 150px!important;
    }
</style>
{% endblock %} {% load string_filters %} {% block content %}
<div class="card">
    <div class="card-header">
        <h4 class="card-title" id="basic-layout-round-controls"><img class="mr-3" src="{% static 'img/voice.png' %}" width="50px" />Track Combination Tool</h4>
        <p class="mb-1 mt-3">Upload one main track file (.mp3) and multiple background track files(.mp3), then set volume level to increase</p>
    </div>
    <div class="card-content">
        <div class="px-3">
            <div class="row">
                <div class="col-6">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">Voice Track Files Upload</h4>
                        </div>
                        <div class="card-content ">
                            <div class="card-body">
                                <form action="{% url 'workspace:upload_voice' %}" method="post" class="dropzone dropzone-area" id="voice-multiple-files" enctype="multipart/form-data">
                                    <div class="dz-message">Drop Files Here To Upload</div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">Background Track Files Upload</h4>
                        </div>
                        <div class="card-content ">
                            <div class="card-body">
                                <form action="{% url 'workspace:upload_background' %}" method="post" class="dropzone dropzone-area" id="background-multiple-files" enctype="multipart/form-data">
                                    <div class="dz-message">Drop Files Here To Upload</div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row mb-2">
    <div class="col-md-3 text-center">
        <input type="number" class="form-control" step="0.1" id="volumeLevel" placeholder="Enter Db value">
    </div>
    <div class="col-md-6 text-left">
        <button type="button" class="btn btn-raised btn-primary" id="start_btn">
            <i class="fa fa-check-square-o"></i> Start
          </button> &nbsp;&nbsp;
        <div class="spinner-border" role="status" style="display: none;">
            <span class="sr-only">Please wait for while audio files are being generated...</span>
        </div>
    </div>

</div>
<div class="row">
    <div class="col-sm-12 col-md-6 col-lg-4">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title">Results</h4>
            </div>
            <div class="card-content">
                <div class="card-body">
                    <ul class="list-group">
                        {% for track in results %}
                        <a href="{% url 'workspace:download_result' %}?filename={{track|urlencode}}" class="list-group-item">{{track}} <i class="ft-download-cloud ml-3"></i></a> {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div>
<!-- 
<div class="row">
    <div class="col-sm-12 col-md-6 col-lg-4">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title"><img class="mr-2" src="{% static 'img/voice.png' %}" width="50px" />Voices &nbsp;</h4>

            </div>
            <div class="card-content">
                <div class="card-body">
                    <ul class="list-group">
                        {% for track in voices %}
                        <li class="list-group-item">
                            <div class="custom-checkbox custom-control-inline ml-3">
                                <input type="checkbox" id="voiceCheckbox{{track}}" name="voiceCheckbox" class="custom-control-input">
                                <label class="custom-control-label" for="voiceCheckbox{{track}}"><span class="badge badge-danger mr-2">{% get_actual_name track %}.mp3</span></label>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 col-md-6 col-lg-4">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title"><img class="mr-2" src="{% static 'img/background.png' %}" width="50px">Backgrounds&nbsp;</h4>
            </div>
            <div class="card-content">
                <div class="card-body">
                    <ul class="list-group">
                        {% for track in backgrounds %}
                        <li class="list-group-item">
                            <div class="custom-checkbox custom-control-inline ml-3">
                                <input type="checkbox" id="backgroundCheckbox{{track}}" name="backgroundCheckbox" class="custom-control-input">
                                <label class="custom-control-label" for="backgroundCheckbox{{track}}"><span class="badge badge-primary mr-2">{% get_actual_name track %}.mp3</span></label>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-12 col-md-6 col-lg-4">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title"><img class="mr-2" src="{% static 'img/results.png' %}" width="50px">Results&nbsp;</h4>
            </div>
            <div class="card-content">
                <div class="card-body">
                    <ul class="list-group">
                        {% for track in results %}
                        <li class="list-group-item">
                            <a href="{% url 'workspace:download_result' %}?filename={{track}}" class="list-group-item">{{track}}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div> -->


{% endblock %} {% block script%}
<script src="{% static 'vendors/js/dropzone.min.js' %}" type="text/javascript"></script>
<script src="{% static 'vendors/js/toastr.min.js' %}" type="text/javascript"></script>
<script>
    Dropzone.autoDiscover = false;

    $(document).ready(function() {
        $(".dropzone-area").dropzone({
                paramName: "file", // The name that will be used to transfer the file
                maxFilesize: 50, // MB
                acceptedFiles: '.mp3',
                addRemoveLinks: false,
                timeout: 5000,
                clickable: true,
                success: function(file, response) {
                    toastr.success("Successfully Uploaded!", "Server Status")
                    console.log(response);
                },
                error: function(file, response) {
                    toastr.error("Error Happened!", "Server Status")
                    return false;
                }

            }

        )

        $("#start_btn").click(function() {
            let level = $("#volumeLevel").val();
            if (level == null || level == "") {
                toastr.error("Error Happened!", "Enter correct volume level!")
                return false;
            }
            $(".spinner-border").show();
            $.ajax({
                _token: '{% csrf_token %}',
                type: "POST",
                url: "{% url 'workspace:proceed' %}",
                data: {
                    level: level
                },
                dataType: 'json',
                success: function(response) {
                    location.reload(true);
                }
            });



        });

    });
</script>
{% endblock %}